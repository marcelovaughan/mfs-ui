{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\nimport clsx from 'clsx';\nimport { useSelector } from 'react-redux';\nimport { withStyles } from \"../../../../packages/material-ui/src/styles\";\nimport Typography from \"../../../../packages/material-ui/src/Typography\";\nimport Paper from \"../../../../packages/material-ui/src/Paper\";\nimport AdCodeFund from \"./AdCodeFund\";\nimport AdCarbon from \"./AdCarbon\";\nimport AdInHouse from \"./AdInHouse\";\nimport { AdContext, adPlacement, adShape } from \"./AdManager\";\n\nconst styles = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block'\n  },\n  'placement-body-image': {\n    margin: theme.spacing(4, 1, 3),\n    minHeight: 126\n  },\n  'placement-body-inline': {\n    margin: theme.spacing(4, 0, 3),\n    minHeight: 126,\n    display: 'flex',\n    alignItems: 'flex-end'\n  },\n  'placement-tocs-top-image': {\n    minHeight: 240\n  },\n  'placement-tocs-bottom-image': {\n    minHeight: 240\n  },\n  paper: {\n    padding: theme.spacing(1.5),\n    border: `2px solid ${theme.palette.primary.main}`,\n    display: 'block'\n  }\n});\n\nfunction PleaseDisableAdblock(props) {\n  const t = useSelector(state => state.options.t);\n  return __jsx(Paper, _extends({\n    component: \"span\",\n    elevation: 0\n  }, props), __jsx(Typography, {\n    variant: \"body2\",\n    display: \"block\",\n    component: \"span\",\n    gutterBottom: true\n  }, t('likeMui')), __jsx(Typography, {\n    variant: \"body2\",\n    display: \"block\",\n    component: \"span\",\n    gutterBottom: true\n  }, t('adblock')), __jsx(Typography, {\n    variant: \"body2\",\n    display: \"block\",\n    component: \"span\",\n    gutterBottom: true\n  }, t('thanks'), ' ', __jsx(\"span\", {\n    role: \"img\",\n    \"aria-label\": t('emojiLove')\n  }, \"\\u2764\\uFE0F\")));\n}\n\nconst disable = false && process.env.ENABLE_AD !== 'true';\nconst inHouseAds = [{\n  name: 'scaffoldhub',\n  link: 'https://scaffoldhub.io/?partner=1',\n  img: '/static/in-house/scaffoldhub.png',\n  description: '<b>Scaffold</b>. Automate building your full-stack Material-UI web-app.'\n}, {\n  name: 'templates',\n  link: 'https://material-ui.com/store/?utm_source=docs&utm_medium=referral&utm_campaign=in-house-templates',\n  img: '/static/in-house/themes-2.jpg',\n  description: '<b>Premium Templates</b>. Start your project with the best templates for admins, dashboards and more.'\n}, {\n  name: 'themes',\n  link: 'https://material-ui.com/store/?utm_source=docs&utm_medium=referral&utm_campaign=in-house-themes',\n  img: '/static/in-house/themes.png',\n  description: '<b>Premium Themes</b>. Kickstart your application development with a ready-made theme.'\n}, {\n  name: 'tidelift',\n  link: 'https://tidelift.com/subscription/pkg/npm-material-ui?utm_source=npm-material-ui&utm_medium=referral&utm_campaign=enterprise&utm_content=ad',\n  img: '/static/in-house/tidelift.png',\n  description: '<b>Material-UI for enterprise</b>. Save time and reduce risk. Managed open source â€” backed by maintainers.'\n}, {\n  name: 'sketch',\n  link: 'https://material-ui.com/store/items/sketch-react/?utm_source=docs&utm_medium=referral&utm_campaign=in-house-sketch',\n  img: '/static/in-house/sketch.png',\n  description: '<b>Sketch</b>. A large UI kit with over 600 handcrafted Material-UI symbols ðŸ’Ž.'\n}, {\n  name: 'figma',\n  link: 'https://material-ui.com/store/items/figma-react/?utm_source=docs&utm_medium=referral&utm_campaign=in-house-figma',\n  img: '/static/in-house/figma.png',\n  description: '<b>Figma</b>. A large UI kit with over 600 handcrafted Material-UI components ðŸŽ¨.'\n}];\n\nvar _ref = __jsx(\"span\", null);\n\nvar _ref2 = __jsx(AdCodeFund, null);\n\nvar _ref3 = __jsx(AdCarbon, null);\n\nfunction Ad(props) {\n  const {\n    placement,\n    classes\n  } = props;\n  const [adblock, setAdblock] = React.useState(null);\n  const [carbonOut, setCarbonOut] = React.useState(null);\n  const [codeFundOut, setCodeFundOut] = React.useState(null);\n  let children; // Hide the content to google bot.\n\n  if (/Googlebot/.test(navigator.userAgent) || disable) {\n    children = _ref;\n  }\n\n  const {\n    current: randomAdblock\n  } = React.useRef(Math.random());\n  const {\n    current: randomInHouse\n  } = React.useRef(Math.random());\n  let minHeight;\n\n  if (!children && adblock) {\n    minHeight = 'auto';\n\n    if (randomAdblock < 0.2) {\n      children = __jsx(PleaseDisableAdblock, {\n        className: classes.paper\n      });\n    } else {\n      children = __jsx(AdInHouse, {\n        ad: inHouseAds[Math.floor(inHouseAds.length * randomInHouse)]\n      });\n    }\n  }\n\n  const {\n    current: randomSplit\n  } = React.useRef(Math.random());\n\n  if (!children) {\n    if (carbonOut || codeFundOut) {\n      children = __jsx(AdInHouse, {\n        ad: inHouseAds[Math.floor(inHouseAds.length * randomInHouse)]\n      });\n      minHeight = 'auto';\n    } else if (randomSplit < 0.4) {\n      children = _ref2;\n    } else {\n      children = _ref3;\n    }\n  }\n\n  const getEventLabel = () => {\n    let label;\n\n    if (children.type === AdCodeFund) {\n      label = 'codefund';\n    } else if (children.type === AdCarbon) {\n      label = 'carbon';\n    } else if (children.type === AdInHouse) {\n      if (!adblock && codeFundOut) {\n        label = 'in-house-codefund';\n      } else if (!adblock && carbonOut) {\n        label = 'in-house-carbon';\n      } else {\n        label = 'in-house';\n      }\n    } else if (children.type === PleaseDisableAdblock) {\n      label = 'in-house-adblock';\n    }\n\n    return label;\n  };\n\n  const ad = React.useContext(AdContext);\n  const eventLabel = getEventLabel();\n  const eventValue = `${adPlacement === 'body' ? ad.portal.placement : adPlacement}-${adShape}`;\n  const timerAdblock = React.useRef();\n  const checkAdblock = React.useCallback((attempt = 1) => {\n    if (document.querySelector('.cf-wrapper') || document.querySelector('#carbonads') || codeFundOut || carbonOut) {\n      if (document.querySelector('#carbonads a') && document.querySelector('#carbonads a').getAttribute('href') === 'https://material-ui-next.com/discover-more/backers') {\n        setCarbonOut(true);\n      }\n\n      setAdblock(false);\n      return;\n    }\n\n    if (attempt < 30) {\n      timerAdblock.current = setTimeout(() => {\n        checkAdblock(attempt + 1);\n      }, 500);\n    }\n\n    if (attempt > 6) {\n      setAdblock(true);\n    }\n  }, [codeFundOut, carbonOut]);\n  React.useEffect(() => {\n    if (disable) {\n      return undefined;\n    }\n\n    checkAdblock();\n    return () => {\n      clearTimeout(timerAdblock.current);\n    };\n  }, [checkAdblock]);\n  React.useEffect(() => {\n    const handler = event => {\n      if (event.detail.status === 'no-advertiser') {\n        setCodeFundOut(true);\n      }\n    };\n\n    window.addEventListener('codefund', handler);\n    return () => {\n      window.removeEventListener('codefund', handler);\n    };\n  }, []);\n  React.useEffect(() => {\n    // Avoid an exceed on the Google Analytics quotas.\n    if (Math.random() < 0.9) {\n      return undefined;\n    }\n\n    const delay = setTimeout(() => {\n      if (!eventLabel) {\n        return;\n      }\n\n      window.ga('send', {\n        hitType: 'event',\n        eventCategory: 'ad',\n        eventAction: 'display',\n        eventLabel,\n        eventValue\n      });\n\n      if (eventLabel.indexOf('in-house') === 0) {\n        window.ga('send', {\n          hitType: 'event',\n          eventCategory: 'in-house-ad',\n          eventAction: 'display',\n          eventLabel: children.props.ad.name,\n          eventValue\n        });\n      }\n    }, 2500);\n    return () => {\n      clearTimeout(delay);\n    };\n  }, [eventLabel, children.props.ad, eventValue]); // Refresh the ad after 1m30.\n  // An approximation to trigger when coming back to the window tab \"after a while\".\n\n  const [key, setKey] = React.useState(0);\n  React.useEffect(() => {\n    const interval = setInterval(() => {\n      setKey(currentKey => currentKey + 1);\n    }, 90000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n\n  if (adPlacement !== placement) {\n    return null;\n  }\n\n  return __jsx(\"span\", {\n    className: clsx(classes.root, classes[`placement-${adPlacement}-${adShape}`]),\n    style: {\n      minHeight: adPlacement === 'body' ? minHeight : null\n    },\n    \"data-ga-event-category\": \"ad\",\n    \"data-ga-event-action\": \"click\"\n    /* advertiser network */\n    ,\n    \"data-ga-event-label\": eventLabel\n    /* docs placement */\n    ,\n    \"data-ga-event-value\": eventValue\n  }, /*#__PURE__*/React.cloneElement(children, {\n    key\n  }));\n}\n\nexport default /*#__PURE__*/React.memo(withStyles(styles)(Ad));","map":null,"metadata":{},"sourceType":"module"}